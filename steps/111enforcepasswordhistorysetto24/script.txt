$fileName = "C:\secpol.cfg"
$size = "24"

# Export current security settings to a file
secedit /export /cfg "$fileName"

$passwordHistorySize = Get-Content "$fileName" | 
    Select-String 'PasswordHistorySize'

if ($passwordHistorySize -and $passwordHistorySize `
    -match 'PasswordHistorySize\s*=\s*$size') {
        
    Write-Host "PasswordHistorySize is already set to $size."
    
} else {
    
    # Modify the configuration file
    (Get-Content "$fileName") `
        -replace 'PasswordHistorySize = [0-9]+', 'PasswordHistorySize = $size' | 
        Set-Content "$fileName"
    Get-Content "$fileName" | Select-String 'PasswordHistorySize'
    
    # Apply the modified security settings
    secedit /configure /db secedit.sdb /cfg "$fileName" /areas SECURITYPOLICY
}

# Clean up - remove the temporary file
Remove-Item "$fileName"