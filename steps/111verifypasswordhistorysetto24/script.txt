$fileName = "C:\secpol.cfg"
$size = "24"

# Export current security settings to a file
secedit /export /cfg "$fileName"

$passwordHistorySize = Get-Content "$fileName" | 
    Select-String 'PasswordHistorySize'

if ($passwordHistorySize -and $passwordHistorySize `
    -match 'PasswordHistorySize\s*=\s*$size') {
        
    Write-Host "PasswordHistorySize is set to $size."
    # Clean up - remove the temporary file
    Remove-Item "$fileName"
    exit 0
    
} else {
    
    Write-Host "PasswordHistorySize is NOT set to $size."
    # Clean up - remove the temporary file
    Remove-Item "$fileName"
    exit 1
    
}